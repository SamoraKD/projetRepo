var AutoSuggest,__extends,Bing,sa_inst;(function(n){var t;(function(n){var t,i,r,u,f,e;(function(n){n.User="SRCHHPGUSR"})(t=n.CookieNames||(n.CookieNames={})),function(n){n.AutoSuggest="AS"}(i=n.CrumbNames||(n.CrumbNames={})),function(n){n.CursorPosition="cp";n.ConversationId="cvid";n.SuggestionCount="sc";n.PartialQuery="pq";n.SuggestionPosition="sp";n.SuggestionType="qs";n.PreviewPaneSuggestionType="qsc";n.SkipValue="sk";n.PreviewPaneSkipValue="skc";n.Ghosting="ghc";n.Css="css";n.Count="count";n.DataSet="ds";n.SessionId="sid";n.TimeStamp="qt";n.Query="q";n.ImpressionGuid="ig";n.QFQuery="qry";n.BaseQuery="bq";n.FormCode="form";n.HashedMuid="nclid";n.RequestElToken="elvr";n.ElTokenValue="elv";n.AppId="appid";n.History="history";n.NoHistory="nohs";n.ApiTextDecoration="textdecorations";n.ClientId="clientid";n.Market="mkt";n.Scope="scope";n.CountryCode="cc";n.HomeGeographicRegion="hgr";n.SetLang="setlang";n.ZeroInputSerp="zis";n.ASVersion="asv"}(r=n.QueryParams||(n.QueryParams={})),function(n){n.ImpressionGuid="X-MSEdge-IG"}(u=n.Headers||(n.Headers={})),function(n){n.HitHighlighting="h";n.PopularNow="p";n.Local="l";n.Answers="a"}(f=n.Options||(n.Options={})),function(n){n.Id="id";n.Query="query";n.Url="url";n.Navigation="nav";n.Type="stype";n.Autocomplete="hc";n.InstData="h";n.AriaLabel="aria-label";n.RequestGuid="rg";n.AdQuery="adq"}(e=n.SuggestionAttributes||(n.SuggestionAttributes={}))})(t=n.Service||(n.Service={}))})(AutoSuggest||(AutoSuggest={})),function(n){var t;(function(n){var t;(function(n){function s(n){return n?n[n[i]!==undefined?i:u]:undefined}function r(n,t){n&&t!==null&&t!==undefined&&(n[n[i]!==undefined?i:u]=t)}function h(n){return _w.getComputedStyle?_w.getComputedStyle(n,null):n.currentStyle}function c(n,t){var r=new RegExp("[?&]{1}"+t+"=([^&]+)"),i=n.match(r);return i?i[1]:null}function l(n,t,i){if(n.setSelectionRange)n.setSelectionRange(t,i);else{var r=n.createTextRange();r.moveEnd("sentence",-1e5);r.moveStart("character",t);r.moveEnd("character",i-t);r.select()}}function a(n,t){for(var r,i,u=0;i=t[u];++u)r=n.getAttribute(i),r&&(n[i]=r)}function v(n){var t=sj_ev(n);return{x:t.clientX,y:t.clientY}}function y(n,t){return function(i){var r=sj_ev(i),u=r.relatedTarget||(r.type=="mouseout"?r.toElement:r.fromElement);t===u||f(u,t)||n.call(t,r)}}function p(n,t){var i=0,r=_d.selection;if(n.selectionStart!=null)i=n.selectionStart;else if(r&&n.createTextRange){t&&n.focus();var u=n.createTextRange(),f=u.duplicate(),e=r.createRange();t&&u.moveToBookmark(e.getBookmark());f.setEndPoint("EndToStart",e);i=f.text.length}return i}function w(n,t){n&&(n.className=n.className.replace(t,""))}function b(n,t){var u,i,r,f;if(n){for(u=n.className.split(" "),i=0,r=u;i<r.length;i++)if(f=r[i],f===t)return;n.className.length>0&&(n.className+=" ");n.className+=t}}function k(n,t){return n?n.replace(o,function(n,i){return t[i]}):n}function d(n,t){var i=t.replace(/\s+$/g,"");return t[t.length-1]==" "&&n.length>0&&ut(t,i,n[0])?i:t}function f(n,t){if(!n||!t||t===n)return!1;while(n&&t!==n)n=n.parentElement;return t==n}function g(n,t,i){var u=e.exec(t);if(!u||!u[1])throw new Error("Given text format doesn't contain link markup");r(i,u[1]);r(n,sa_loc.SearchRemoved);n.innerHTML=n.innerHTML.replace("%e"+i.innerHTML+"%E",rt(i))}function nt(n,t,i,r){var u,f;return i===void 0&&(i=null),r===void 0&&(r=!1),u=_d.createElement("span"),u.textContent=t,u.style.visibility="hidden",i&&(u.style.fontSize=i),r&&(u.style.fontWeight="bold"),n.appendChild(u),f=u.offsetWidth,n.removeChild(u),f}function tt(n,t,i){try{return n()}catch(r){return i&&i(),t}}function it(n){return n?"Bearer "+n:""}function rt(n){var t=sj_ce("div");return t.appendChild(n),t.innerHTML}function ut(n,t,i){return n==i.substr(0,n.length)||t==i}function t(n){var t=Math.abs(Math.floor(n));return(t<10?"0":"")+t}function ft(){var n=new Date,i=-n.getTimezoneOffset(),r=i>=0?"+":"-";return n.getFullYear()+"-"+t(n.getMonth()+1)+"-"+t(n.getDate())+"T"+t(n.getHours())+":"+t(n.getMinutes())+":"+t(n.getSeconds())+"."+t(n.getMilliseconds())+r+t(i/60)+":"+t(i%60)}function et(t,i,r,u,f,e){var s,o;if(!t||!i||!r)return"";s=encodeURIComponent(i);o={triggeringMode:"Explicit",intent:r};u&&(o.entityId=u);e&&(o.itemId=e);f&&(o.contentSource=f);var c=JSON.stringify(o),l=encodeURIComponent(c),h=n.formatString(t.bfbSearchUrl,[s,l,t.bfbfrmcde]);return _G&&_G.IG?h+"&cvid="+encodeURIComponent(_G.IG):h}function ot(n){var t="/search";return n&&n.substr(0,t.length)===t?"/work"+n:n}var i="textContent",u="innerText",e=/%e([^%]+)%E/,o=/{([0-9]+)}/g;n.GetTextContent=s;n.SetTextContent=r;n.GetComputedStyle=h;n.GetQueryStringParam=c;n.SetSelectionRange=l;n.RewriteAttribsToProps=a;n.GetMouseCoords=v;n.MouseEnterLeave=y;n.getCursorPosition=p;n.RemoveClassName=w;n.AddClassName=b;n.formatString=k;n.TrimmedQueryFromSuggestions=d;n.isChildOf=f;n.SetTextContentWithLink=g;n.CalcWidth=nt;n.safeExecute=tt;n.getBearerTokenHeader=it;n.getDateWithTimezone=ft;n.buildBfbSearchUrl=et;n.getMSBWorkVerticalSearchUrl=ot})(t=n.Utils||(n.Utils={}))})(t=n.AS||(n.AS={}))}(Bing||(Bing={})),function(n){var t;(function(n){var i=function(){function n(){this._eventRegistry=[]}return n.prototype.registerEvents=function(n){this._eventRegistry.push(n)},n.prototype.raiseEvent=function(n){for(var i,r,f,u=[],t=1;t<arguments.length;t++)u[t-1]=arguments[t];for(i=0,r=this._eventRegistry;i<r.length;i++)f=r[i],f.raise(n,u)},n.prototype.clearEvents=function(){this._eventRegistry=[]},n}(),t;n.EventRegisterer=i;t=function(){function n(n){this._eventParent=n;this.events=[]}return n.prototype.add=function(n,t){this.events[n]=t},n.prototype.proxy=function(n){for(var i,r,e,u=this,f=[],t=1;t<arguments.length;t++)f[t-1]=arguments[t];for(i=0,r=f;i<r.length;i++)e=r[i],function(t){u.events[t]=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];r.splice(0,0,t);n.apply(u._eventParent,r)}}(e)},n.prototype.raise=function(n,t){var i=this.events[n];i&&i.apply(this._eventParent,t)},n}();n.EventRegistration=t})(t=n.AS||(n.AS={}))}(Bing||(Bing={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(t){var i,h,s;(function(n){n.Web="Web";n.BingAtWork="BAW";n.Substrate="SSUE";n.MicrosoftSearchInBing="MSB";n.MicrosoftSearchInBingCached="MSBC";n.MSBEngagment="MSBE"})(i=t.DataSources||(t.DataSources={})),function(n){n.Bookmarks="Bookmarks";n.People="People"}(h=t.BingAtWorkDataTypes||(t.BingAtWorkDataTypes={}));var r=AutoSuggest.Service.QueryParams,e="ajax.unload",c="msb:qf:rdy",u="NONPROM",f="PROM",o=[r.SuggestionPosition,r.Ghosting,],l=o.concat([r.PartialQuery,r.SuggestionCount,r.SuggestionType,r.SkipValue,r.ConversationId,]);t.searchBoxFocusEventId="SearchBox_Focus";s=function(s){function h(n,t,i,r,u,f,e,o,h,c,l){var a=s.call(this)||this;return a.canvas=n,a._dataProvider=t,a._bingAtWorkDataProvider=i,a._substrateDataProvider=r,a._msbDataProvider=u,a._msbEngagementDataProvider=f,a._instrumentation=e,a._bingAtWorkSuggestionsParser=o,a._substrateSuggestionsParser=h,a._msbSuggestionsParser=c,a._bingAtWorkWebTelemetry=l,a.currentQuery="",a.data={},a.ghostInstValue=0,a.networkLatencyInfo="",a._cursorPosition=0,a._queryWithCurrentSuggestions="",a._receivedAtLeastOnceValidResponse=!1,a._isDisposed=!1,a._requestSequence=-1,a._isBawPayloadAdded=!1,a._originalQuery="",a._previousLocationCache=null,a._emptyWebSuggestionsResponse="<span><\/span>",a.msbNtpKeyStrokeMaxRetry=0,a.isMsbCachingBundleReady=!1,a}return __extends(h,s),h.prototype.init=function(n,i,r){var u=this,e,s,c,l,f,a,v,o;for(this._originalQuery=r.value,this.config=n,this._container=i,this.registerAjaxSerpUnloadEvent(),e=0,s=h.ScopeExtensions;e<s.length;e++)c=s[e],c.init(this);h.ScopeExtensions=[];l=function(n,t,i,r,f){return u.dataProviderCallbackFunc(n,t,i,r,f)};this._dataProvider.init(n,n.u,l);this.canvas.init(this,n,i,r);f=new t.EventRegistration(this);f.proxy(this.raiseEvent,10,12,11);this._bingAtWorkDataProvider&&(a=function(n,t,i,r,f,e){return u.onBingAtWorkResponseReceived(n,t,i,e)},this._bingAtWorkDataProvider.init(n,this.config.bingAtWorkUrl,a));this._substrateDataProvider&&(v=function(n,t,i){return u.onSubstrateResponseReceived(n,t,i)},this._substrateDataProvider.init(n,"",v));this._msbDataProvider&&(o=function(n,t,i,r,f){return u.onSearchBoxFocusWithRetry(1,i,function(){return u.onMsbResponseReceived(n,t,i,r,f)})},this._msbDataProvider.init(o));this._msbEngagementDataProvider&&(o=function(n,t){return u.onSearchBoxFocusWithRetry(1,t,function(){return u.onMsbEngagementResponseReceived(n,t)})},this._msbEngagementDataProvider.init(o));f.add(4,function(n,t,i){u.raiseEvent(4,n,t,i)});f.add(20,function(n,t){t.className.indexOf("as_qb")!=-1&&(u.raiseEvent(13,n.query+" ",!1),_w.Log&&Log.Log&&Log.Log("Select","QueryBuilder","Click",!1,"ImpressionGuid",u.data.Inst.IG))});f.add(25,function(n){u.raiseEvent(13,n.query+" ",!1);_w.Log&&Log.Log&&Log.Log("Select","MobileNextWordSuggestion","Click",!1,"ImpressionGuid",u.data.Inst.IG)});this.canvas.registerEvents(f);this.raiseEvent(6,this);n.isEdgeNtp&&this.isMsbEnabled(n.enabledDataSources)&&(this.msbNtpKeyStrokeMaxRetry=n.msbKsTnsTryMax||0,this.raiseEvent(21));(n.msbqc||this.config.isNtpClientqfEnabled)&&this.initMsbQfCaching()},h.prototype.initMsbQfCaching=function(){for(var r=this,t=!1,n=0;n<this.config.enabledDataSources.length;++n)if(this.config.enabledDataSources[n]===i.MicrosoftSearchInBing){this.config.enabledDataSources.splice(n,null,i.MicrosoftSearchInBingCached);t=!0;break}t||this.config.enabledDataSources.push(i.MicrosoftSearchInBingCached);sj_evt.bind(c,function(){return r.isMsbCachingBundleReady=!0},!0)},h.prototype.isMsbEnabled=function(n){var r,t,u,f;if(!n)return!1;for(r=!1,t=0,u=n;t<u.length;t++)if(f=u[t],f===i.BingAtWork||f===i.MicrosoftSearchInBing){r=!0;break}return r},h.prototype.raiseUpdateGhostedText=function(n,t,i){this.raiseEvent(14,n,t,i)},h.prototype.raiseUpdateTextAndRequery=function(n,t){this.raiseEvent(13,n,t)},h.prototype.raiseUpdateText=function(n){this.raiseEvent(12,n)},h.prototype.raiseTextChanged=function(n,t){this.raiseEvent(18,n,t)},h.prototype.onBfbNavigateCallback=function(n,t,i,r,e){if(this._bingAtWorkWebTelemetry){var o={LogicalId:_G.LogicalId?_G.LogicalId:"",N:r?r.length:0,QTYP:t,TT:i?f:u,eventId:"QueryFormulation_Click"};this._bingAtWorkWebTelemetry.logClicked(n,o);this._bingAtWorkWebTelemetry.log3SClickedEvent("QueryFormulation_Click",e)}},h.prototype.onHighConfidencePromoted=function(n){if(this._bingAtWorkWebTelemetry&&this.config.enableQfHcLog){var t=this._bingAtWorkWebTelemetry.getLogicalId(),i={LogicalId:t,N:this.currentQuery.length,TT:n?f:u,eventId:"QueryFormulation_HighConfidence_Impression"};this._bingAtWorkWebTelemetry.logShown("",i)}},h.prototype.onBfbSearchBoxAction=function(n){this._bingAtWorkWebTelemetry&&(n===t.searchBoxFocusEventId&&this._bingAtWorkWebTelemetry.createAndUpdateConversationId&&this._bingAtWorkWebTelemetry.createAndUpdateConversationId(),this._bingAtWorkWebTelemetry.log3SClickedEvent&&this._bingAtWorkWebTelemetry.log3SClickedEvent(n))},h.prototype.onSubstrateNavigateCallback=function(n){this._substrateDataProvider&&this._substrateDataProvider.instrumentClick(n)},h.prototype.setData=function(n){this.data=n},h.prototype.dataProviderCallbackFunc=function(r,u,f,e,o){var a,v,h,c,y,p,l,s,w;(this._previousLocationCache=o||this._previousLocationCache,!this._isDisposed&&(this.canvas.searchBoxHasFocus()||this.config.mnw))&&(t.CachedResponseUtils&&t.CachedResponseUtils.checkCachedResponseAndLog&&(r=t.CachedResponseUtils.checkCachedResponseAndLog(r,e)),this.raiseEvent(8),f==this.currentQuery)&&r!=null&&(this.raiseEvent(9,f,u,i.Web),this._queryWithCurrentSuggestions=f,this.canvas.render(r,this.currentQuery,u,i.Web),this._receivedAtLeastOnceValidResponse=!0,this.config.enbleClientPerfTelemetry&&this._instrumentation&&this._instrumentation.logASNetworkCallLatency&&typeof performance!="undefined"&&performance&&performance.getEntries&&(a=this._instrumentation.logASNetworkCallLatency(),a!==""&&this.appendLatency(a)),v=_ge("sa_msbblockheader"),h=_ge("sa_msbblockheaderwithtenantname"),h&&v&&(c=v,y=n.AS.BingAtWorkTemplateManager.getTenantDisplayName(),y&&(p=h.innerHTML.replace("{0}",y),p.length<=70&&(c=h,c.innerHTML=p)),c.style.display="block",l=_ge("as_msbblkhdrnew"),s=n.AS.BingAtWorkTemplateManager.getTenantThemeColors(),s&&s.length>2&&(l===null||l===void 0?void 0:l.setAttribute("style","background-color : #"+s[1]+"; color : #"+s[2]+";"))),this._instrumentation&&(w=this.data&&this.data.Inst?this.data.Inst.IG:null,this._instrumentation.updateImpressionGuid(w,u)))},h.prototype.onSubstrateResponseReceived=function(n,r,u){var f=this,e,o;!this._isDisposed&&this.canvas.searchBoxHasFocus()&&u==this.currentQuery&&(this.config.handleDuplicateFetch&&r<this._requestSequence||(e=sb_gt(),o=function(n,o){var s=t.BingAtWorkTemplateManager.generateHtml(f.config,n,u);n.length&&(f._instrumentation.instrumentResponseReceived(i.Substrate,r,e),f._bingAtWorkWebTelemetry&&f._bingAtWorkWebTelemetry.logPerf("SSUESuggestions"));f._instrumentation.instrumentDataSource(i.Substrate,n,r,o);f.config.msbSusR&&(f._substrateDataProvider.updateTraceId(o.TraceID),f.canvas.render(s,f.currentQuery,r,i.Substrate),s&&(f._instrumentation.updateRendered(r),f._bingAtWorkWebTelemetry&&(f._bingAtWorkWebTelemetry.setContext({traceId:o.TraceID,tenantId:f.config.bawTenantId,uid:f.config.bawUserId}),n.forEach(function(n){f._bingAtWorkWebTelemetry.logShown(n.id)}))))},this._substrateSuggestionsParser.parse(u,n,r,o)))},h.prototype.onMsbEngagementResponseReceived=function(n,r){if(!this._isDisposed&&this.canvas.searchBoxHasFocus()&&r==this.currentQuery&&(!this.config.handleDuplicateFetch||!(n<this._requestSequence))){var u=t.BingAtWorkTemplateManager.generateMSBEngagementHtml(this.config,r,this.config.msbengagementformcode);u&&this.canvas.render(u,this.currentQuery,n,i.MSBEngagment)}},h.prototype.onMsbResponseReceived=function(n,r,e,o,s){var h=this;if(!this._isDisposed&&this.canvas.searchBoxHasFocus()&&e==this.currentQuery&&(!this.config.handleDuplicateFetch||!(r<this._requestSequence))){var l=sb_gt(),c=o?i.MicrosoftSearchInBingCached:i.MicrosoftSearchInBing,a=function(n,i,o){var a,s,v,p,w;if(a=h.config.promoteUserHistoryForAADUser&&c==="MSBC"?t.BingAtWorkTemplateManager.generateMsbHtml(h.config,n,e,h.config.isMsbInline,o===null||o===void 0?void 0:o.LogicalId):h.config.webMsbQFRanking&&c==="MSBC"?t.BingAtWorkTemplateManager.generateMsbHtml(h.config,n,e,h.config.isMsbInline,o===null||o===void 0?void 0:o.LogicalId):t.BingAtWorkTemplateManager.generateHtml(h.config,n,e,h.config.isMsbInline),n.length&&h._instrumentation.instrumentResponseReceived(c,r,l),h._instrumentation.instrumentDataSource(c,n,r,i),h.canvas.render(a,h.currentQuery,r,c),a&&(h.config.isEdgeNtp||h._instrumentation.updateRendered(r),h._bingAtWorkWebTelemetry)){h._bingAtWorkWebTelemetry.setContext({traceId:i?i.TraceID:"",tenantId:h.config.bawTenantId});var b=h._bingAtWorkWebTelemetry.getLogicalId(),k=JSON.stringify(n.map(function(n){return n.stype})),y={LogicalId:b,N:h.currentQuery.length,QTYP:k,TT:u};if(h.config.isLowConfidenceWeb)for(s=0,v=n;s<v.length;s++)if(p=v[s],p.confidence=="High"){y.TT=f;break}w=JSON.stringify(n.map(function(n){return n.id}));h._bingAtWorkWebTelemetry.logShown(w,y);h._bingAtWorkWebTelemetry.log3sRenderedEvent(o)}};this._msbSuggestionsParser.parse(n,r,a,s)}},h.prototype.onBingAtWorkResponseReceived=function(n,r,u,f){var e=this,o,s;!this._isDisposed&&this.canvas.searchBoxHasFocus()&&u==this.currentQuery&&(this.config.handleDuplicateFetch&&r<this._requestSequence||(o=sb_gt(),this.config.isEdgeNtp&&(this.raiseEvent(8),f==401&&this.msbNtpKeyStrokeMaxRetry>0&&(this.msbNtpKeyStrokeMaxRetry--,this.raiseEvent(21))),s=function(n,f){var s=t.BingAtWorkTemplateManager.generateHtml(e.config,n,u,e.config.isMsbInline);n.length&&(e.config.isEdgeNtp?e.raiseEvent(9,u,r,i.BingAtWork):(e._instrumentation&&e._instrumentation.instrumentResponseReceived(i.BingAtWork,r,o),e._bingAtWorkWebTelemetry&&e._bingAtWorkWebTelemetry.logPerf("BAWSuggestions")));e._instrumentation&&e._instrumentation.instrumentDataSource(i.BingAtWork,n,r,f);e.canvas.render(s,e.currentQuery,r,i.BingAtWork);s&&(!e.config.isEdgeNtp&&e._instrumentation&&e._instrumentation.updateRendered(r),e._bingAtWorkWebTelemetry&&(e._bingAtWorkWebTelemetry.setContext({traceId:f.TraceID,tenantId:e.config.bawTenantId}),n.forEach(function(n){e._bingAtWorkWebTelemetry.logShown(n.id)})))},this._bingAtWorkSuggestionsParser.parse(u,n,r,s)))},h.prototype.getAllSuggestionInstUrl=function(n,t){for(var u,f,o=this.getInstrumentationKeys(t),i=[],r=0,e=o;r<e.length;r++)u=e[r],f=this.getSuggestionInstValue(u,!0,n),f!==null&&(i=i.concat(["&",u,"=",f]));return i.join("")},h.prototype.getAllSuggestionInstObject=function(n,t){for(var r,u,o=this.getInstrumentationKeys(t),f={},i=0,e=o;i<e.length;i++)r=e[i],u=this.getSuggestionInstValue(r,!1,n),u!==null&&(f[r]=u);return f},h.prototype.getInstrumentationKeys=function(n){return n?l:o},h.prototype.getSuggestionInstValue=function(n,t,i){i=i||this.canvas.selectedSuggestion;switch(n){case r.SuggestionCount:return this.canvas.currentSuggestionList.length+"-"+this._queryWithCurrentSuggestions.length;case r.PartialQuery:return t?encodeURIComponent(this._queryWithCurrentSuggestions):this._queryWithCurrentSuggestions;case r.SuggestionPosition:return this.config.mnw&&i&&i.ord>this.canvas.mnwSuggestionsCount&&(i.ord=i.ord-this.canvas.mnwSuggestionsCount),i?""+i.ord:this.config.mnw&&this.isMNWSuggestionSelected(this.canvas.clickedMNWSuggestionType)?this.canvas.clickedMNWSuggestionPosition.toString():"-1";case r.SuggestionType:return i?i.src:this.config.mnw&&this.isMNWSuggestionSelected(this.canvas.clickedMNWSuggestionType)?this.canvas.clickedMNWSuggestionType:"n";case r.SkipValue:return i&&i.sk?i.sk:"";case r.Ghosting:return this.ghostInstValue==0?null:this.ghostInstValue.toString();case r.ConversationId:return _G.IG;default:return null}},h.prototype.isMNWSuggestionSelected=function(n){return n=="MNW"||n=="MNWU"||n=="MNWB"||n=="MNWT"||n=="MNWF"?!0:!1},h.prototype.setCursorPosition=function(n){this._cursorPosition=n},h.prototype.finalizeKeystroke=function(){this._instrumentation&&this._requestSequence>-1&&this._instrumentation.finalizeKeystroke(this._requestSequence)},h.prototype.fetch=function(n){this.finalizeKeystroke();this._requestSequence++;this._instrumentation&&this._instrumentation.beginRequest(this._requestSequence);this.fetchWeb(n,this._requestSequence,!1);(this.config.msbqc||this.config.isNtpClientqfEnabled)&&this.isMsbCachingBundleReady?this.fetchMsb(n,this._requestSequence):this.config.msbqc||this.fetchBingAtWork(n,this._requestSequence);this.config.msbSusE&&this.fetchSubstrate(n,this._requestSequence);this._msbEngagementDataProvider&&this._msbEngagementDataProvider.show(n,this._requestSequence)},h.prototype.fetchZeroQF=function(){this.config.enableZeroQfWork&&(this.finalizeKeystroke(),this._requestSequence++,this._instrumentation&&this._instrumentation.beginRequest(this._requestSequence),this.fetchWeb("",this._requestSequence,!1),(this.config.msbqc||this.config.isNtpClientqfEnabled)&&this.isMsbCachingBundleReady&&this.fetchZeroQf(this._requestSequence))},h.prototype.fetchSubstrate=function(n,i){if(this._substrateDataProvider&&this.currentQuery.length>=this.config.bawminqlen){var r=t.BingAtWorkTemplateManager.getTenantConfig(this.config);r&&r.displayName&&this._substrateDataProvider.fetch(n,i,!1)}},h.prototype.fetchBingAtWork=function(n,i){if(this._bingAtWorkDataProvider&&this.currentQuery.length>=this.config.bawminqlen){var r=t.BingAtWorkTemplateManager.getTenantConfig(this.config);r&&r.displayName?(this.addBawPayload(n),this._bingAtWorkDataProvider.fetch(n,i,!1)):this.config.isEdgeNtp&&this.msbNtpKeyStrokeMaxRetry>0&&(this.msbNtpKeyStrokeMaxRetry--,this.raiseEvent(21))}},h.prototype.fetchMsb=function(n,i){var r,u,e,f;((r=this._bingAtWorkWebTelemetry)===null||r===void 0?void 0:r.isQfLoggerExists)&&this._bingAtWorkWebTelemetry.isQfLoggerExists()&&(e=this._bingAtWorkWebTelemetry.createQfLoggerContext());this._msbDataProvider&&this.currentQuery.length>=this.config.bawminqlen&&(f=t.BingAtWorkTemplateManager.getTenantConfig(this.config),f&&f.displayName&&(((u=this._bingAtWorkWebTelemetry)===null||u===void 0?void 0:u.isQfLoggerExists)&&this._bingAtWorkWebTelemetry.isQfLoggerExists()?this._msbDataProvider.fetch(n,i,e):this._msbDataProvider.fetch(n,i)))},h.prototype.fetchZeroQf=function(n){var t,i,r;((t=this._bingAtWorkWebTelemetry)===null||t===void 0?void 0:t.isQfLoggerExists)&&this._bingAtWorkWebTelemetry.isQfLoggerExists()&&(r=this._bingAtWorkWebTelemetry.createQfLoggerContext());this._msbDataProvider&&this.currentQuery==""&&(((i=this._bingAtWorkWebTelemetry)===null||i===void 0?void 0:i.isQfLoggerExists)&&this._bingAtWorkWebTelemetry.isQfLoggerExists()?this._msbDataProvider.fetchZeroQF(n,r):this._msbDataProvider.fetchZeroQF(n))},h.prototype.addBawPayload=function(n){var r=this.config.bawmax,t,i;this._isBawPayloadAdded?this._bingAtWorkDataProvider.addPostValue("Query",n):(t=["Bookmark","Qna","Building"],this.config.msbSusR||t.push("Person"),i={count:r,domains:t,query:n,conversationId:_G.IG},this._bingAtWorkDataProvider.addBody(i))},h.prototype.onSearchBoxFocusWithRetry=function(n,t,i,r){var u=this;if(t!==this.currentQuery){r&&r();return}this.canvas.searchBoxHasFocus()?i():n<5&&sb_st(function(){u.onSearchBoxFocusWithRetry(n+1,t,i,r)},15)},h.prototype.fetchWeb=function(n,t,u){var f,e;this.config.msbnocons&&this._receivedAtLeastOnceValidResponse?this.canvas.render(this._emptyWebSuggestionsResponse,this.currentQuery,t,i.Web):(this.config.shouldUseAsCodeVersion&&this._dataProvider.addParam(r.ASVersion,"1"),this._dataProvider.addParam(r.CursorPosition,this._cursorPosition.toString()),this._container!=null&&this._container.parentNode!=null&&(f=this._container.parentNode.offsetWidth.toString(),this.config.cors?this._dataProvider.addParam("contentWidth",f):this._dataProvider.addHeader("X-Autosuggest-ContentWidth",f)),_ge("sidebar_search_experience")&&this._dataProvider.addHeader("X-SIDEBAR-SEARCH","true"),this._receivedAtLeastOnceValidResponse||this._dataProvider.addParam(r.Css,"1"),this.config.ezis&&this._originalQuery===n&&this._requestSequence==0&&this._dataProvider.addParam(r.ZeroInputSerp,"1"),this.config.pc&&this._dataProvider.addParam("pubcode",this.config.pc),this.config.footnote&&this._dataProvider.addParam("footnote","1"),this.config.adcached&&this._adCachedQuery&&this._adCachedImpressionGuid&&(this._dataProvider.addParam("adq",this._adCachedQuery),this._dataProvider.addParam("adig",this._adCachedImpressionGuid)),this.config.pcov&&(e=this.getPartnerCodeOverride(),e&&this._dataProvider.addParam("pc",e)),this._msbDataProvider==null&&this._bingAtWorkDataProvider==null&&this._dataProvider.addParam("msbqf","false"),this.config.IsBingPrivate&&this._dataProvider.addHeader("preferAnonymous","1"),this._dataProvider.fetch(n,t,!0),this.raiseEvent(7,this.currentQuery,t),u||sj_evt.fire("AS.RequestSent",this.currentQuery))},h.prototype.registerAjaxSerpUnloadEvent=function(){var n=this,t=function(i){var r=i&&i[1];r&&r.isInstantRequest||(n._isDisposed=!0,sj_evt.unbind(e,t),n.raiseEvent(17),n.clearEvents())};sj_evt.bind(e,t,!1)},h.prototype.getPartnerCodeOverride=function(){var n,t=(n=_ge(this.config.f))===null||n===void 0?void 0:n.querySelector("[name='pc']"),r=t&&t.value,u=_d.location.href.indexOf("ntp.msn.com/edge/ntp")>=0||_d.location.href.indexOf("ntp.msn.cn/edge/ntp")>=0,i;return!r&&u&&(i="U531"),i},h.prototype.setRawQuery=function(n){this.canvas.updateRawQuery(n)},h.prototype.setQuery=function(n){if(this.currentQuery=n,typeof n=="undefined"||n.length==0&&!this.config.fetchOnEmpty){this.fetchZeroQF();return}this.fetch(n)},h.prototype.pretechQuery=function(n){this.fetchWeb(n,0,!0)},h.prototype.setAdCachedQuery=function(n,t){this._adCachedQuery=n;this._adCachedImpressionGuid=t},h.prototype.appendLatency=function(n){this.networkLatencyInfo=this.data&&this.data.Inst?this.networkLatencyInfo==""?this.data.Inst.IG+":"+n:this.networkLatencyInfo+"&"+this.data.Inst.IG+":"+n:this.networkLatencyInfo==""?n:this.networkLatencyInfo+"&"+n},h.ScopeExtensions=[],h}(t.EventRegisterer);t.WebCore=s})(t=n.AS||(n.AS={}))}(Bing||(Bing={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(n){var u=AutoSuggest.Service.QueryParams,t="sa_errorCnt",i=function(){function n(){this._callParams={};this._callHeaders={};this._callBody={}}return n.prototype.fetchUrl=function(){},n.prototype.init=function(n,t,i){this._config=n;this._baseUrl=t;this._callbackFunc=i},n.prototype.addParam=function(n,t){this._callParams[n]=t},n.prototype.addHeader=function(n,t){if(this._config.cors)throw"Custom headers are not allowed for cross domain calls";this._callHeaders[n]=t},n.prototype.addPostValue=function(n,t){this._callBody[n]=t},n.prototype.addBody=function(n){this._callBody=n},n.prototype.fetch=function(n,t,i){this._requestSequence=t;var r=this.getFinalFetchUrl(n);this.fetchUrl(r,n,t,i)},n.prototype.getBaseUrl=function(){return this._baseUrl},n.prototype.isPostCall=function(){return this._callBody&&typeof this._callBody=="object"&&Object.keys(this._callBody).length>0},n.prototype.getFinalFetchUrl=function(n){var i=decodeURIComponent(this.getBaseUrl())+encodeURIComponent(n),t;this.addParam(u.ConversationId,_G.IG);this._config.adform&&this.addParam("form",this._config.adform);for(t in this._callParams)i+="&"+t+"="+this._callParams[t];return this._callParams={},i},n}(),r;n.DataProviderBase=i;r=function(i){function r(){return i!==null&&i.apply(this,arguments)||this}return __extends(r,i),r.prototype.fetchUrl=function(i,r,u,f){var o=this,e=sj_gx(),s,h;e.open(this.isPostCall()?"POST":"GET",i,!0);for(s in this._callHeaders)e.setRequestHeader(s,this._callHeaders[s]);this._callHeaders={};e.onreadystatechange=function(){var s,n,h,c,l;if(e.readyState==4){if(e.onreadystatechange=function(){},s=void 0,n=e.status,n==200?s=e.responseText:_w[t]&&(n==0||(n/100|0)==4||(n/100|0)==5)&&(s=_w[t]),h=null,f&&(!o._config.cors||o._config.rbhc)&&e.getResponseHeader&&(h=e.getResponseHeader("X-BingQF-BLIS")),o._config.instHeader&&e.getResponseHeader&&(c=e.getResponseHeader("X-BingQF-It"),c))try{l=JSON.parse(c);l.Inst&&sa_inst.setData(l)}catch(a){}o._callbackFunc(s,u,r,i,h,n)}};e.withCredentials!==undefined&&(e.withCredentials=!0);this.isPostCall()?(h=n.Utils.safeExecute(function(){return JSON.stringify(o._callBody)},""),e.send(h)):e.send()},r}(i);n.DataProvider=r})(t=n.AS||(n.AS={}))}(Bing||(Bing={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(n){var y=["MD","ADS"],p=["CustomSearch"],e=["previousSibling","nextSibling"],o=["lastChild","firstChild"],s="sa_hv",h=/(\s|^)sa_hv/g,r="data-sugcont",w="as_rsform",c=/(\s|^)as_rsform/g,b="asexpand",k=/(\s|^)asexpand/g,u="BAWC",d="bw-cn",l=",",a="result",t=n.Utils,i=AutoSuggest.Service.SuggestionAttributes,v=[n.DataSources.BingAtWork,n.DataSources.Substrate,n.DataSources.MicrosoftSearchInBing,n.DataSources.MicrosoftSearchInBingCached],f={RS:"RS",PAA:"PAA",PASF:"PASF"},g=function(g){function nt(){var n=g.call(this)||this;return n.currentSuggestionList=[],n._ie9orLower=sb_ie&&!_w.atob,n._currentRequestSequence=-1,n._suggestionsQueue={},n._hasSwitched=!1,n}return __extends(nt,g),nt.prototype.init=function(t,i,r,u){this.autoSuggestInstance=t;this.config=i;this.container=r;this._searchBox=u;this._asContainer=_ge(i.c||"sw_as");var f=new n.EventRegistration(this);f.add(17,this.clearEvents);this.autoSuggestInstance.registerEvents(f);this._hasPrefixQueryBeenUpdated=!1;this.nextWordRemoved=!1;this.hasAsExpanded=!1;this._searchTypeDivIndex=0},nt.prototype.updateWidth=function(){var r=_ge("sw_as"),t,u,f,i;if(this.nextWordRemoved&&r&&(t=document.querySelectorAll("li.sa_sg"),u=n.Utils.GetComputedStyle(r).width,t))for(f=t.length,i=0;i<f;i++)t[i].style.width=u},nt.prototype.removeNextWordOnMSBHistory=function(t){var e=_ge("sw_as"),i,u,r,f,o;if(t&&e&&(i=document.querySelectorAll("li.sa_sg"),u=i===null||i===void 0?void 0:i.length,u>0)){for(r=0;r<u;r++)i[r].stype.indexOf("NW")!=-1&&(i[r].parentElement.removeChild(i[r]),this.nextWordRemoved=!0);this.nextWordRemoved&&(f=document.querySelector(".sa_as.sa_nw"),f&&f.classList.remove("sa_nw"),this.containsNextWord=!1,o=new n.Layout(this.config,e,this),o.update())}},nt.prototype.lastElementBorderCurve=function(){var u,i,r,e,h,n,o,f,s;if(!this.config.isMobile){if(u="0 0 0 0",this.config.enableAsPanelExpansion){if(i=document.querySelector(".as_rmhswarning"),r=document.querySelector(".sa_as"),r&&r!=undefined&&r.style.removeProperty("borderRadius"),!_ge("sa_baw")){i&&i!=undefined&&(this.hasAsExpanded?(r&&r!=undefined&&(r.style.borderRadius=u),t.AddClassName(i,b)):t.RemoveClassName(i,k));return}this.hasAsExpanded&&i&&i!=undefined&&(e=document.querySelector(".sa_as"),e&&e!=undefined&&(e.style.borderRadius=u))}else if(!_ge("sa_baw"))return;if((h="sa_ul",_ge(h))&&(n=_ge(h),n.children&&n.children.length&&n.lastElementChild)){var a=n.lastElementChild,c=document.querySelectorAll("#sw_as #sa_ul > div"),l=c.length;if(l!==0){for(o=0;o<l;o++)if(f=c[o],f.children&&f.children.length){if(f===a){s=n.children.length;s>1&&n.children[s-2].tagName.toUpperCase()==="LI"&&(n.children[s-2].style.borderRadius=u);break}f.lastElementChild.style.borderRadius=u}return}}}},nt.prototype.render=function(i,r,u,f){var et,b,k,p,g,ot,st,o,y,s,nt,it,ht,tt,ut,ct,rt,pt,wt,bt,ft,lt,kt,at,vt,dt,w,h,l;for(u>this._currentRequestSequence&&(this._suggestionsQueue={},this._currentQuery=r,this._currentRequestSequence=u),this._suggestionsQueue[f]={suggestions:i,rendered:!1,dataSource:f},this.nextWordRemoved=!1,this.hasAsExpanded=!1,b="",k=0;k<this.config.enabledDataSources.length;k++){var a=[],d=this.config.enabledDataSources,e=this._suggestionsQueue[d[k]],yt=!1;if(!e){this.lastElementBorderCurve();return}if(e.rendered){k==this.config.enabledDataSources.length-1&&this.lastElementBorderCurve();continue}for(p=_ge("sa_baw"),g=null,v.indexOf(e.dataSource)!=-1&&(p?this.config.msbSusR&&(g=this.config.bawmax*2-p.children.length):this.config.promoteUserHistoryForAADUser&&e.dataSource==="MSBC"?(o=e.suggestions.split("|||"),e.suggestions="",o&&o.length==3&&(o[0]!=""&&(yt=!0,e.suggestions='<div data-region="BAWC" id="bawuh" data-sugcont="1" role="none">'+o[0]+"<\/div>"),o[1]!=""&&(e.suggestions+="|||"+('<div data-region="BAWC" id="bawh" data-sugcont="1" role="none">'+o[1]+"<\/div>")),o[2]!=""&&(e.suggestions+="|||"+('<div data-region="BAWC" id="sa_baw" data-sugcont="1" role="none">'+o[2]+"<\/div>")),y=n.BingAtWorkTemplateManager===null||n.BingAtWorkTemplateManager===void 0?void 0:n.BingAtWorkTemplateManager.replaceLocalizedStringsInMSBHtml(e.suggestions,r),y&&(ot='<li id="as_foot"',y.indexOf(ot)!=-1?(st=y.split(ot),e.suggestions=st[0]+"<\/div>",b='<li id="as_foot"'+st[1].split("<\/div>")[0]):e.suggestions=y))):this.config.webMsbQFRanking&&e.dataSource==="MSBC"?(o=e.suggestions.split("|||"),e.suggestions=o[0]!=""?'<div data-region="BAWC" id="bawh" data-sugcont="1" role="none">'+o[0]+"<\/div>|||"+('<div data-region="BAWC" id="sa_baw" data-sugcont="1" role="none">'+o[1]+"<\/div>"):'<div data-region="BAWC" id="sa_baw" data-sugcont="1" role="none">'+o[1]+"<\/div>"):e.dataSource!=="MSBE"&&(e.suggestions='<div data-region="BAWC" id="sa_baw" data-sugcont="1" role="none">'+e.suggestions+"<\/div>")),e.dataSource==="MSBE"&&(y=n.BingAtWorkTemplateManager===null||n.BingAtWorkTemplateManager===void 0?void 0:n.BingAtWorkTemplateManager.replaceLocalizedStringsInMSBEHtml(e.suggestions,r),y&&(e.suggestions=y)),d[0]==e.dataSource&&(this.container.innerHTML="",this.currentSuggestionList=[],this._currentSuggestion=null,this.selectedSuggestion=null,this._hasSwitched=!1,this._currentMsbSuggestionsListSize=0,this.containsNextWordInWebSuggestions=!1,this._searchBox.removeAttribute("aria-activedescendant")),s=void 0,nt=this.container.getElementsByTagName("UL"),h=0;h<nt.length;h++)if(nt[h].className.indexOf("sa_drw")!=-1){s=nt[h];break}if(p=_ge("sa_baw"),e.dataSource==="MSBE"||!p||(s=p),this.config.promoteUserHistoryForAADUser&&e.dataSource==="MSBC"&&e.suggestions.indexOf("|||")!=-1){for(tt=e.suggestions.split("|||"),this.removeNextWordOnMSBHistory(yt),it=0,ht=tt;it<ht.length;it++)rt=ht[it],l=this.createDivFromAjaxResponse(rt),this.insertAjaxResponseDivIntoDom(s?s:this.container,l,g,e.dataSource),this.buildSuggestions(a,e.dataSource);this.updateWidth()}else if(this.config.webMsbQFRanking&&e.dataSource==="MSBC"&&e.suggestions.indexOf("|||")!=-1)for(tt=e.suggestions.split("|||"),ut=0,ct=tt;ut<ct.length;ut++)rt=ct[ut],l=this.createDivFromAjaxResponse(rt),this.insertAjaxResponseDivIntoDom(s?s:this.container,l,g,e.dataSource),this.buildSuggestions(a,e.dataSource);else e.dataSource==="MSBE"&&this.containsNextWordInWebSuggestions||(l=this.createDivFromAjaxResponse(e.suggestions),this.config.webMsbQFRanking&&this.setLowConfidenceWebSignal(l),this.insertAjaxResponseDivIntoDom(s?s:this.container,l,g,e.dataSource),this.config.enableAsPanelExpansion&&this.hasAsExpanded&&e.dataSource=="MSBE"&&(pt=_d.querySelector("#asmsbribbon_li"),pt.previousElementSibling.style.marginBottom="41px"),this.buildSuggestions(a,e.dataSource),e.dataSource==="Web"&&(this.containsNextWordInWebSuggestions=this.containsNextWord),wt=document.getElementsByClassName("b_searchboxForm")[0],this.config.enableAsPanelExpansion&&!this.containsNextWordInWebSuggestions&&e.dataSource==="Web"&&this.shouldShowOtherSuggestions()?this.showSearchType(e,this.config.enabledSearchTypes,s,a,this.config.maxSuggestionsToShow):this.config.enableAsPanelExpansion&&!this.shouldShowOtherSuggestions()&&t.RemoveClassName(wt,c));if(this._previousQuery=this._currentQuery,this._searchTypeDivs=_d.querySelectorAll("#sa_ul"),e.rendered=!0,e.dataSource==n.DataSources.Web)if(a.length>0)this.config.bi&&(bt={currentQuery:r,suggestionElements:a,requestSequence:u},sj_evt.fire("AS.SuggestionsRendered",bt));else for(ft=0,lt=d;ft<lt.length;ft++)if(kt=lt[ft],v.indexOf(kt)!=-1){at=sj_ce("ul",this.config.slid,"sa_drw");at.setAttribute("data-priority","2");this.container.appendChild(at);break}a.length>0&&(sj_evt.fire("AS.Canvas.Show"),this.raiseEvent(10,r,a,u,this.container,e.dataSource));this.currentSuggestionList.length===0&&(sj_evt.fire("AS.Canvas.Hide"),d[d.length-1]==e.dataSource?this.raiseEvent(11,r):f===n.DataSources.Web&&this.raiseEvent(24,r))}for(dt=[],w=(et=this.container)===null||et===void 0?void 0:et.getElementsByTagName("UL"),h=0;h<(w===null||w===void 0?void 0:w.length);h++)if(w[h].className.indexOf("sa_drw")!=-1){vt=w[h];break}b&&b!=""&&(l=this.createDivFromAjaxResponse(b),this.insertAjaxResponseDivIntoDom(vt&&!this.hasAsExpanded?vt:this.container,l,1,"MSB"),this.buildSuggestions(dt));this.lastElementBorderCurve()},nt.prototype.updateRawQuery=function(n){this._rawQuery=n},nt.prototype.showSearchType=function(n,i,r,u,f){var o,s,e;if(u===void 0&&(u=[]),o=document.getElementsByClassName("b_searchboxForm")[0],s=this.addOtherSuggesstionsOnAsPanel(i,f),s!==undefined)for(this.hasAsExpanded=!0,t.AddClassName(o,w),this.insertAjaxResponseDivIntoDom(r?r:this.container,s,f.reduce(function(n,t){return n+t},0),n.dataSource),e=0;e<i.length;++e)this.buildSuggestions(u,i[e]);else t.RemoveClassName(o,c)},nt.prototype.addOtherSuggesstionsOnAsPanel=function(n,t){for(var f,i="",r=0;r<n.length;++r){var e=this.getSuggestionsAndLabel(n[r],t[r]),u=e[0],o=e[1];u&&u.length!==0&&(i+=o+u)}return i&&i.length!==0&&(f=this.createDivFromAjaxResponse("<div class='sa_drw'>"+i+"<\/div>")),f},nt.prototype.getSuggestionsAndLabel=function(t,i){return typeof n.SearchTypeUtils=="undefined"?["",""]:t===f.RS?[n.SearchTypeUtils.getRsSuggestions(this._previousQuery,this._currentQuery,i),sa_loc.RelatedSearches?"<p class='rs_tx'>"+sa_loc.RelatedSearches+"<\/p>":"<p class='rs_tx'>Related Searches<\/p>"]:t===f.PAA?[n.SearchTypeUtils.getPaaAnswers(this._previousQuery,this._currentQuery,i,this.config.hitHighlightPaa),sa_loc.PeopleAlsoAsk?"<p class='paa_tx'>"+sa_loc.PeopleAlsoAsk+"<\/p>":"<p class='paa_tx'>People Also Ask<\/p>"]:t===f.PASF?[n.SearchTypeUtils.getPASFData(this._previousQuery,this._currentQuery,i),sa_loc.PeopleAlsoSearchFor?"<p class='pasf_tx'>"+sa_loc.PeopleAlsoSearchFor+"<\/p>":"<p class='pasf_tx'>People Also Search For<\/p>"]:["",""]},nt.prototype.shouldShowOtherSuggestions=function(){var n=_d.querySelectorAll("#sa_ul li");return n===undefined||n.length==0?!1:(this._hasPrefixQueryBeenUpdated=this._hasPrefixQueryBeenUpdated||this._previousQuery!==undefined&&this._previousQuery!==this._currentQuery,!this._hasPrefixQueryBeenUpdated)},nt.prototype.getNumberOfSuggestionsToBuild=function(n){var i,t,r;if(n===void 0&&(n="AS"),i=0,n==="Web")this._suggestionsContainer=_ge(this.config.slid);else if(n==="RS")t=_d.querySelectorAll("#sa_ul.rs_drw");else if(n==="PAA")t=_d.querySelectorAll("#sa_ul.paa_drw");else if(n==="PASF")t=_d.querySelectorAll("#sa_ul.psaf_rs_drw");else{if(n==="MSBC")return t=_d.querySelectorAll("[data-region="+u+"]"),t&&t.length>0&&(r=t.length,this._suggestionsContainer=t[r-1],i=t[r-1].childElementCount),i;n==="MSBE"?t=_d.querySelectorAll("#sa_ul"):this._suggestionsContainer=_ge(this.config.slid)}return t&&t.length>0&&(this._suggestionsContainer=t[0],i=t[0].childElementCount),i},nt.prototype.buildSuggestions=function(f,e){var w,it,k,y,o,h,ut,p,s,g,nt,c,tt;if(e===void 0&&(e="Web"),this._nextWordRawQuerySize=null,this._largestSuggestion=0,this._nextWordRawQuerySize=1e4,this.containsNextWord=!1,this.mnwSuggestionsCount=0,it=this.getNumberOfSuggestionsToBuild(e),this._suggestionsContainer){var b=this._suggestionsContainer.getElementsByTagName("li"),v=this.currentSuggestionList.length,rt=b.length;for(this.config.webMsbQFRanking&&this._hasSwitched&&(v=this._currentMsbSuggestionsListSize,this._currentMsbSuggestionsListSize+=b.length-this.currentSuggestionList.length,rt=this._currentMsbSuggestionsListSize,this._hasSwitched=!1),k=this.nextWordRemoved?0:v,k=it>0?0:v,y=k;y<rt;++y)if(o=b[y],h=o.parentNode,h.id===this.config.slid||h.getAttribute(r)||h.className==="sa_mnw_region"){if(o.className.indexOf("sa_hd")!=-1){o.hd=!0;continue}if(t.RewriteAttribsToProps(o,[i.Url,i.Query,i.Type,i.Autocomplete,i.RequestGuid,i.AdQuery]),o.stype)if(o.stype=="HS")s=o.firstElementChild,s&&s.setAttribute("aria-hidden","true");else if(o.stype!="PN"){for(ut=((w=o.children)===null||w===void 0?void 0:w.length)||0,p=0;p<ut;p++)s=o.children[p],s&&s.setAttribute("aria-hidden","true");g="";h.getAttribute("data-region")==u&&(nt=o.getElementsByClassName(d),g=nt.length>0?[l,nt[0].innerText,o.stype.toLowerCase(),a].join(" "):[l,o.stype.toLowerCase(),a].join(" "),this.config.enableMsbQFWorkRedirect&&(o.url=n.Utils.getMSBWorkVerticalSearchUrl(o.url),o.setAttribute("url",o.url)));o.setAttribute("aria-label",o.innerText+g)}o.className.indexOf("pp_tile")!=-1&&(o.panel={ot:sb_gt()});o.stype&&this.isSuggestionTypeInstrumentationDisabled(o.stype)||(o.addInst=!0);o.stype&&this.isNavigationalSuggestion(o.stype)&&(o.nav=!0);this.config.mnw&&(o.stype=="MNW"||o.stype=="MNWU"||o.stype=="MNWB"||o.stype=="MNWT"||o.stype=="MNWF")&&(this.mnwSuggestionsCount+=1);this.config.eNw&&o.stype&&o.stype.indexOf("NW")>-1&&(this.containsNextWord=!0,this.config.nwRz&&(c=o.textContent||o.innerText,c&&(tt=o.query.replace(c,""),c.length>this._largestSuggestion&&tt.length<=this._nextWordRawQuerySize&&(this._largestSuggestion=c.length,this._nextWordRawQuerySize=tt.length,this.largestNextWordElement=o))));this.currentSuggestionList.push(o.query);this.decorateSuggestion(o,++v);f.push(o)}}},nt.prototype.isSuggestionTypeInstrumentationDisabled=function(n){for(var r,t=0,i=y;t<i.length;t++)if(r=i[t],r===n)return!0;return!1},nt.prototype.isNavigationalSuggestion=function(n){for(var r,t=0,i=p;t<i.length;t++)if(r=i[t],r===n)return!0;return!1},nt.prototype.mouseOverSuggestionHandler=function(t,i){var r=n.Utils.GetMouseCoords(t);i.url&&this._previousMouseCoords&&(this._previousMouseCoords.x!=r.x||this._previousMouseCoords.y!=r.y)?(this._previousMouseCoords=r,i.className.indexOf(s)==-1&&this.highlightSuggestion(i)):this._previousMouseCoords=this._previousMouseCoords||r},nt.prototype.decorateSuggestion=function(t,i){var r=this,u;t.src=t.stype;t.ord=i;sj_be(t,"mousemove",function(n){return r.mouseOverSuggestionHandler(n,t)});sj_be(t,"mouseover",function(i){var u=n.Utils.MouseEnterLeave(function(n){return r.mouseOverSuggestionHandler(n,t)},t);u(i)});sj_be(t,"mousedown",function(n){return r.onMouseDownSuggestion(n,t)});sj_be(t,"mouseup",function(n){r.cancelEventBubbling(n);r.onMouseUpSuggestion(n,t)});u=window.navigator.msPointerEnabled?"onMSPointerDown":"ontouchstart";u.toLowerCase()in _w&&sj_be(t,u.substr(2),function(n){if(t.it="m",n.pointerType)switch(n.pointerType){case n.MSPOINTER_TYPE_TOUCH:t.it="t";break;case n.MSPOINTER_TYPE_PEN:t.it="p"}else t.it="t"})},nt.prototype.getSearchDivIndex=function(n){for(var t=0;t<this._searchTypeDivs.length;++t)if(this._searchTypeDivs[t].className.indexOf(n)>-1)return t;return 0},nt.prototype.getTargetElementExpandAs=function(n,t,i){var l,s,h;i===void 0&&(i=0);var a=e[t],c=o[t],f=n?n[a]:this._searchTypeDivs[this._searchTypeDivIndex][c];return f?(l=f.getAttribute(r),l&&f.innerHTML?(f=f[c],this.isSuggestionElement(f)||(f=this.getTargetElementExpandAs(f,t))):this.isSuggestionElement(f)||(f=this.getTargetElementExpandAs(f,t))):this._currentSuggestion&&(s=this._currentSuggestion.parentElement,s.getAttribute("data-region")&&s.getAttribute("data-region")===u&&i<2?f=this.getTargetElementExpandAs(s,t,i+1):(this._searchTypeDivIndex=this.getSearchDivIndex(s.className),h=!1,this._searchTypeDivIndex===this._searchTypeDivs.length-1&&t===1&&(h=!0),this._searchTypeDivIndex=(this._searchTypeDivIndex+this._searchTypeDivs.length+(t===1?1:-1))%this._searchTypeDivs.length,this.unHighlightSuggestionHandler(),f=h?undefined:this.getTargetElementExpandAs(null,t))),f},nt.prototype.getTargetElement=function(n,t){var h=e[t],f=o[t],i=n?n[h]:_ge(this.config.slid)[f],s,u;return i?(s=i.getAttribute(r),s&&i.innerHTML?(i=i[f],this.isSuggestionElement(i)||(i=this.getTargetElement(i,t))):this.isSuggestionElement(i)||(i=this.getTargetElement(i,t))):this._currentSuggestion&&(u=this._currentSuggestion.parentNode,this.unHighlightSuggestionHandler(),u.getAttribute(r)&&(i=this.getTargetElement(u,t))),i},nt.prototype.isSuggestionElement=function(n){return n.url&&n.tagName==="LI"},nt.prototype.selectItem=function(n){var t=this.config.enableAsPanelExpansion&&this.hasAsExpanded?this.getTargetElementExpandAs(this._currentSuggestion,n):this.getTargetElement(this._currentSuggestion,n),i;t?(this.setSearchValue(t),this.highlightSuggestion(t)):this.clearSelectedSuggestion();this.config.bi&&(i={currentQuery:this._currentQuery,suggestionElements:[t],requestSequence:this._currentRequestSequence},sj_evt.fire("AS.SuggestionSelected",i))},nt.prototype.isClickOnElementWithClass=function(n,t){var i=n.target;return i&&i.className.indexOf(t)>-1},nt.prototype.cancelEventBubbling=function(n){n=sj_ev(n);sj_sp(n)},nt.prototype.highlightSuggestion=function(n){this.unHighlightSuggestionHandler();this._currentSuggestion=n;this.addHighlightClassName(this._currentSuggestion);this._currentSuggestion!=n&&this.addHighlightClassName(n);this._searchBox.setAttribute("aria-activedescendant",n.id);n.setAttribute("aria-selected","true")},nt.prototype.unHighlightSuggestionHandler=function(){this._currentSuggestion&&(this.removeHighlightClassName(this._currentSuggestion),this._currentSuggestion.removeAttribute("aria-selected"),this._currentSuggestion=null)},nt.prototype.clearSelectedSuggestion=function(){this.setSearchValue();this.unHighlightSuggestionHandler();this._searchBox.removeAttribute("aria-activedescendant")},nt.prototype.addHighlightClassName=function(n){h.test(n.className)||(n.className+=" "+s)},nt.prototype.removeHighlightClassName=function(n){t.RemoveClassName(n,h)},nt.prototype.onMouseDownSuggestion=function(n,t){n=sj_ev(n);var i=n.button;i==2?(this.cancelEventBubbling(n),sj_pd(n)):t.url&&(this.clickedSuggestion=t)},nt.prototype.onMouseUpSuggestion=function(n,t){this.clickedSuggestion&&this.clickedSuggestion==t&&(n=sj_ev(n),this.config.clickIco&&this.isClickOnElementWithClass(n,"as_icon")?this.raiseEvent(20,t,sj_et(n)):(this.config.mnw&&(t.stype=="MNW"||t.stype=="MNWU"||t.stype=="MNWB"||t.stype=="MNWT"||t.stype=="MNWF")?(this._currentQuery=this._currentQuery.substring(0,this._currentQuery.lastIndexOf(" ")+1).concat(this.clickedSuggestion.query),this.clickedSuggestion.query=this._currentQuery,this.clickedMNWSuggestionType=this.clickedSuggestion.stype,this.clickedMNWSuggestionPosition=this.config.mnwbtm?90+this.clickedSuggestion.ord-(this.currentSuggestionList.length-this.mnwSuggestionsCount):90+this.clickedSuggestion.ord,this.highlightSuggestion(this.clickedSuggestion),this.raiseEvent(25,this.clickedSuggestion)):(this.setSearchValue(this.clickedSuggestion),sj_evt.fire("AS.Navigate",t,"mouseup"),this.raiseEvent(4,t,!1,this.config.linkTarget)),this.clickedSuggestion=null))},nt.prototype.searchBoxHasFocus=function(){return typeof this._searchBox!="undefined"&&typeof this._searchBox.getRootNode=="function"?this._searchBox.getRootNode().activeElement===this._searchBox:_d.activeElement==this._searchBox},nt.prototype.setSearchValue=function(n){var t,i;this.raiseEvent(19,this.selectedSuggestion,n);this.selectedSuggestion=n;t=this._currentQuery;this.config.trimwsnr&&this._rawQuery&&this._rawQuery[this._rawQuery.length-1]==" "&&(t=t+" ");i="";i=n?n.rg?this.autoSuggestInstance.currentQuery:n.query:t;this.raiseEvent(12,i)},nt.prototype.getCssHolder=function(){var n=_ge("ajaxStyles"),t,i;return n||(n=sj_ce("div"),n.id="ajaxStyles",t=_ge("srchfrm"),i=t!=null&&typeof t.getRootNode!="undefined"&&t.getRootNode(),i&&i!=_d&&t?t.appendChild(n):sj_b.insertBefore(n,sj_b.firstChild)),n},nt.prototype.insertScriptIntoDom=function(n){var r=this,t=sj_ce("script"),i;t.type=n.type;i=n.getAttribute("src");i?t.setAttribute("src",i):(t.setAttribute("data-bing-script","1"),t.text=n.innerHTML);n.parentNode.removeChild(n);this._asContainer.appendChild(t);sb_st(function(){r._asContainer.contains(t)&&r._asContainer.removeChild(t)},1)},nt.prototype.insertStyleIntoDom=function(t){this._ie9orLower?(sj_ic(t.innerHTML),t.parentNode.removeChild(t)):(t.setAttribute("data-rms","1"),this.autoSuggestInstance.config.bi&&n.Utils.AddClassName(t,"bi_preserve"),this.getCssHolder().appendChild(t))},nt.prototype.createDivFromAjaxResponse=function(n){if(!n)return undefined;var t=sj_ce("div");return t.innerHTML=n,t},nt.prototype.setLowConfidenceWebSignal=function(n){var t,i;this.config.isLowConfidenceWeb=!1;i=n===null||n===void 0?void 0:n.childNodes[0];((t=i)===null||t===void 0?void 0:t.hasAttribute("data-lowconfweb"))&&(this.config.isLowConfidenceWeb=!0)},nt.prototype.insertAjaxResponseDivIntoDom=function(n,t,i){var r,e;if(t){for(var u=_d.createDocumentFragment(),o=t.childNodes,f=!1,s=!1;o.length;){r=o[0];switch(r.tagName){case"SCRIPT":this.insertScriptIntoDom(r);break;case"STYLE":this.insertStyleIntoDom(r);break;default:i===null||i>0?(r.id==="bawh"&&(f=!0),r.id==="bawuh"&&(s=!0,this.handleDuplicatesForAADUserHistory(n,r)),u.appendChild(r),i!=null&&i--):t.removeChild(r)}}if(s?(n.insertBefore(u,n.firstChild),this._hasSwitched=!0):this.config.webMsbQFRanking&&f&&this.config.isLowConfidenceWeb?(e=n.firstElementChild,e.id==="bawuh"?(n.insertBefore(u,e.nextSibling),this._hasSwitched=!0):(n.insertBefore(u,n.firstChild),this._hasSwitched=!0)):n.appendChild(u),this._suggestionsQueue.Web&&this._suggestionsQueue.Web.rendered&&this._suggestionsQueue.MSBC&&!this._suggestionsQueue.MSBC.rendered)this.autoSuggestInstance.onHighConfidencePromoted(f&&this.config.isLowConfidenceWeb)}},nt.prototype.handleDuplicatesForAADUserHistory=function(n,t){var f,r,i,u;if(n&&t)for(f=t.childNodes,r=n.childNodes,i=0;i<r.length;i++)for(u=0;u<f.length;u++)r[i].getAttribute("query")==f[u].getAttribute("query")&&(r[i].style.display="none")},nt}(n.EventRegisterer);n.Canvas=g})(t=n.AS||(n.AS={}))}(Bing||(Bing={})),function(n){var t;(function(n){var i="sa_nw",r=/(\s|^)sa_nw/g,t=36,u=function(){function u(t,i,r){this.config=t;this._container=i;this._canvas=r;this._isRtl=n.Utils.GetComputedStyle(sj_b).direction=="rtl";this._isRtl&&this._container.setAttribute("dir","rtl");this._searchBoxElem=_ge(t.i);this._outerContainer=sj_ce("div","","sa_as");this._outerContainer.setAttribute("data-priority","2");this.hide();this._container.appendChild(this._outerContainer)}return u.prototype.getSuggestionsDrawer=function(){return this._outerContainer},u.prototype.show=function(){this._outerContainer.style.display="block"},u.prototype.hide=function(){this._outerContainer.style.display="none"},u.prototype.setMargin=function(n,i){var r=0,u=0;return this.config.searchBoxSpyglass&&(r=this._isRtl?t:t*-1,u=this._isRtl?t*-1:t),this._isRtl?[i+u,n+r]:[n+u,i+r]},u.prototype.update=function(){var h,t,f,u=n.Utils.GetComputedStyle(this._container.parentNode),c,l,o;if(this.config.eNw&&this.config.nwRz&&this._canvas.containsNextWord&&this._canvas.largestNextWordElement){this.setMargins(0,0);c=n.Utils.GetComputedStyle(this._searchBoxElem);sj_evt.fire("AS.Layout.NextWord.Show");n.Utils.AddClassName(this._outerContainer,i);l=this._outerContainer.style.display;this.setCanvasVisibility("hidden","block");var e=this._canvas.largestNextWordElement,a=n.Utils.GetTextContent(e),s=this.getFirstChild(e),v=e.query.replace(a,""),y=s&&s.innerHTML.indexOf("<strong>")>-1,p=n.Utils.CalcWidth(e,s&&s.textContent||a,null,y),w=n.Utils.CalcWidth(e,v,c.fontSize);t=w+4;f=this._outerContainer.offsetWidth-t-p-this.getNwExtraSz(e)-4;h=this.setMargin(t,f);t=h[0];f=h[1];this.setCanvasVisibility("",l);this.config.IsBingPrivate&&(o=_ge("as_foot"),t!=0||f!=0?o!=null&&(o.style.display="none"):o!=null&&(o.style.display="list-item"))}else sj_evt.fire("AS.Layout.NextWord.Hide"),n.Utils.RemoveClassName(this._outerContainer,r),this._isRtl?(f=(this.toFloat(u.paddingRight)+this.toFloat(u.borderRightWidth))*-1,t=this.toFloat(u.borderLeftWidth)-this.toFloat(u.paddingLeft)):(t=(this.toFloat(u.paddingLeft)+this.toFloat(u.borderLeftWidth))*-1,f=this.toFloat(u.borderRightWidth)-this.toFloat(u.paddingRight));this.setMargins(t,f);this._searchBoxElem!=null&&this._searchBoxElem.dir.length>0&&(this._outerContainer.dir=this._searchBoxElem.dir)},u.prototype.toFloat=function(n){var t=parseFloat(n);return isNaN(t)?0:t},u.prototype.setCanvasVisibility=function(n,t){this._outerContainer.style.visibility=n;this._outerContainer.style.display=t},u.prototype.setMargins=function(n,t){this._container.style.marginLeft=n+"px";this._container.style.marginRight=t+"px"},u.prototype.getFirstChild=function(n){return n&&n.childNodes&&n.childNodes.length>0&&n.childNodes[0]},u.prototype.getNwExtraSz=function(t){var r=this.getFirstChild(t),i;return r?(i=n.Utils.GetComputedStyle(r),this.toFloat(i.marginLeft)*2+this.toFloat(i.borderLeft)+this.toFloat(i.borderRight)):0},u}();n.Layout=u})(t=n.AS||(n.AS={}))}(Bing||(Bing={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(n){function r(n){return typeof n=="number"?n:'"'+n.replace(/"/g,'\\"')+'"'}var u="SRCHHPGUSR",f="AS",e=4,t="AS.CurrentImpressionQuerySelected",o="bawh",i=sb_ie&&sb_de.style.opacity===undefined,s=function(s){function h(t,i){var r=s.call(this)||this,u,f,e;for(r.config=t,r.autosuggest=i,r._pollInterval=0,r._pendingRequestCount=0,r._bRequeryOnTextChange=!0,r._hiddenFields=[],r._lastQuery="",r._lastRawQuery="",r._trimRegex=new RegExp("^\\s*","g"),r._removeSpacesRegex=new RegExp("\\s+","g"),r._lastTextChanged="",r._textChangeSequence=0,r._isSearchBoxWebComponent=!1,r.searchBoxTouchAction=function(){r.config.handleClickOnly||r.config.handleDuplicateFetch&&r._lastClickQuery==r.getCurrentQuery(!0)||(r.autosuggest.canvas.searchBoxHasFocus()||r.searchBox.focus(),r.onSearchBoxClick(),r._lastClickQuery=r.getCurrentQuery(!0))},r.addSearchBoxLeftSpyglass=function(){var n=_ge("sb_leftsg"),t;n||(n=sj_ce("div","sb_leftsg"),n.style.display="none",r.searchBox.parentNode.insertBefore(n,r.searchBox));n.innerHTML===""&&(t='<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 25 25"><path stroke="#767676" stroke-width="2.5" stroke-linecap="round" stroke-miterlimit="10" fill="none" d="M23.75 23.75l-9-9"><\/path><circle stroke="#767676" stroke-width="2.5" stroke-linecap="round" stroke-miterlimit="10" cx="9" cy="9" r="7.75" fill="none"><\/circle><path fill="none" d="M25 25h-25v-25h25z"><\/path><\/svg>',n.innerHTML=t)},r.searchBoxClickAction=function(){r._lastClickQuery==r.getCurrentQuery(!0)&&r.autosuggest.canvas.searchBoxHasFocus()||(r.searchBox.focus(),r.config.handleDuplicateFetch&&(r._lastClickQuery=r.getCurrentQuery(!0)),r.onSearchBoxClick());r.config.handleDuplicateFetch||(r._lastClickQuery=null)},r.onSubmit=function(n){var i,u,f,t;if(r.cancelDefaultHandler(n),r.config.ghostingWithGreyText&&r._ghostingText&&r.searchBox.selectionStart!=r.searchBox.selectionEnd&&(i=r.searchBox.value.indexOf(r._ghostingText),i!=-1&&(u=r.searchBox.value.slice(0,i),r.searchBox.value=u),r._ghostingText=null),r.isEmptyQuery()){f=_w._H&&_w._H.sbeb;f&&sb_st(function(){return r.hideDropDown(2)},5);return}if(sb_st(function(){return r.hideDropDown(2)},5),t=r.autosuggest.canvas.selectedSuggestion,sj_evt.fire("AS.Navigate",t,"submit"),t)r.navigate(t,!0,r.config.linkTarget);else{r.submitForm(!0);r.autosuggest.onBfbSearchBoxAction("SearchDone")}},r.onSearchBoxKeyDown=function(n){var e=n.keyCode,i,u,f,t;switch(e){case 27:r.isQueryGhosted()||(r.hideDropDown(1),r.cancelDefaultHandler(n));break;case 38:r._isLayoutVisible&&(r.autosuggest.canvas.selectItem(0),r.cancelDefaultHandler(n));break;case 40:r._isLayoutVisible?r.autosuggest.canvas.selectItem(1):r.config.fetchOnDownArrowKey&&r.fetchForCurrentQuery();break;case 9:if(r._ghostingText=null,!r.isQueryGhosted()){if(n.shiftKey){r.hideDropDownOnFocusChange();break}if(i=function(){var n=!_ge("fbpgdg");n&&(r.autosuggest.canvas.clearSelectedSuggestion(),r.hideDropDownOnFocusChange(),_ge("sb_form_q").focus())},u=function(){var t=_ge("sb_fdb");if(t&&t.style.display!="none"){r.autosuggest.canvas.clearSelectedSuggestion();t.focus();t.onblur=i;n.preventDefault();return}r.hideDropDownOnFocusChange()},r.config.removeSuggUrl){if(f=r.autosuggest.canvas.selectedSuggestion,!f){r.hideDropDownOnFocusChange();break}if(t=r.getSelectedSuggestionRemoveButton(),t){t.tabIndex=0;t.focus();t.onblur=i;n.preventDefault();break}}u()}break;case 39:r._ghostingText=null}},r.getSelectedSuggestionRemoveButton=function(){var i=r.autosuggest.canvas.selectedSuggestion,n,t;return i?(n=i.firstElementChild,!n)?null:n.classList&&n.classList.contains("as_hr")?n:(t=n.lastElementChild,t&&t.classList&&t.classList.contains("sa_rm"))?t.firstElementChild:null:null},r.onSearchBoxClick=function(){r._ghostingText=null;r._isLayoutVisible||r.fetchForCurrentQuery();r.autosuggest.onBfbSearchBoxAction(n.searchBoxFocusEventId)},r.hideDropDownOnFocusChange=function(n){r.hideDropDown(1,n)},r.onTextInput=function(){var n=r.searchBox.value;r.triggerTextChangedEvent(n)},r.raiseEvent(5,t),u=0,f=h.ScopeExtensions;u<f.length;u++)e=f[u],e.init(r);return h.ScopeExtensions=[],r}return __extends(h,s),h.prototype.init=function(t){var e,u,f,r,o,s,i;(this.config.globalId=t,this.config.slid="sa_ul",this._bDisabled=this.isDisabled())||(_w._H&&_w._H.ajax?(e=_ge("serpHeader"),e&&(u=e.getElementsByTagName("form"),u&&u.length>0&&(this.searchForm=u[0],f=this.searchForm.getElementsByClassName("b_searchbox"),f&&f.length>0&&(this.searchBox=f[0])))):(this.searchForm=_ge(this.config.f),this.searchBox=_ge(this.config.i)),this.searchBox&&typeof this.searchBox.shadowRoot!="undefined"&&(this._isSearchBoxWebComponent=!0),this.searchForm.form&&(this.config.fc=this.searchForm.form.value),this._currentImpressionQuery=this.searchBox.value,r=this.getContainer(),sj_be(r,"mousedown",function(n){return sj_sp(n)}),r.style.display="block",this.layout=this._layout=new n.Layout(this.config,r,this.autosuggest.canvas),this.layout.update(),this.registerUIElement(r),this.registerUIElement(this.searchBox),o=_ge("sb_form_go"),o&&this.registerUIElement(o),this._pollInterval=this.config.d,this._pollThrottlingEnabled=this.config.t,s=this._layout.getSuggestionsDrawer(),this.autosuggest.init(this.config,s,this.searchBox),this._lastQuery=this.getQueryToFetch(),this.searchBox.setAttribute("aria-autocomplete","both"),this.searchBox.setAttribute("aria-controls","sw_as"),this.searchForm.setAttribute("aria-live","polite"),this.searchForm.setAttribute("aria-expanded","false"),i=new n.EventRegistration(this),i.add(8,this.handleResponseReceived),i.add(11,this.startNoMatchTimeout),i.add(10,this.showDropDown),i.add(12,this.onUpdateText),i.add(13,this.onUpdateTextAndRequery),i.add(14,this.onUpdateGhostedText),i.add(4,this.navigate),i.add(17,this.dispose),this.autosuggest.registerEvents(i),this.bindEvents(sj_be,sj_evt.bind),this.pollForQueryChange(),this.raiseEvent(6,this))},h.prototype.setData=function(n){this.autosuggest.setData(n)},h.prototype.getCurrentImpressionQuery=function(){return this._currentImpressionQuery},h.prototype.isDisabled=function(){return!this.config.pv&&sj_cook.get(u,f)=="0"},h.prototype.registerUIElement=function(n){sj_be(n,"touchend",sj_sp);sj_be(n,"click",sj_sp)},h.prototype.addHiddenField=function(n,t){var i=sj_ce("input");return i.id="sa_"+n,i.name=n,i.value=t,i.type="hidden",this.searchForm.appendChild(i),this.config.sbt&&this._hiddenFields.push(i),i},h.prototype.cancelDefaultHandler=function(n){sj_sp(n);sj_pd(n)},h.prototype.show=function(){this.config.handleDuplicateFetch&&this._lastClickQuery!=this.getCurrentQuery(!0)&&(this._lastClickQuery=this.getCurrentQuery(!0));this.onSearchBoxClick()},h.prototype.getCursorPosition=function(){return n.Utils.getCursorPosition(this.searchBox,!0)},h.prototype.makeAutoSuggestGPingCall=function(n){var t=_ge(n.replace("&","")),e;if(t&&document.images){var f=t.getAttribute("h"),u=void 0,i={a:[],add:function(n,t){this.a.push(r(n)+":"+r(t))},get:function(){return this.a.length?"&PR={"+this.a.join(",")+"}":""}};i.add("i",this.autosuggest.canvas.clickedSuggestion?t.it||"m":"k");this.autosuggest.ghostInstValue&&i.add("ghc",this.autosuggest.ghostInstValue);t.panel&&i.add("et",sb_gt()-t.panel.ot);u=this.autosuggest.data&&this.autosuggest.data.Inst?this.autosuggest.data.Inst.IG:null;u&&f&&(e=new Image,e.src=this.getGPingUrl()+"IG="+u+"&"+f+i.get())}return!0},h.prototype.getGPingUrl=function(){return _w&&_w.location&&_w.location.host&&_w.location.host.indexOf("bing.com")>-1&&_G.gpUrl?_G.gpUrl:"https://www.bing.com"+_G.gpUrl},h.prototype.navigate=function(n,t,i){var u=this,r;sb_st(function(){return u.hideDropDown(2)},5);this.makeAutoSuggestGPingCall(n.id);r=n.query;n.rg?this.updateSearchBoxValue(this.getLastRequestedQuery()):r!=undefined&&this.updateSearchBoxValue(r);this.config.logClickOnSuggestion&&(t?typeof Log!="undefined"&&Log&&Log.Log&&Log.Log("Autosuggest","Suggestion","EnterClick",!1):typeof Log!="undefined"&&Log&&Log.Log&&Log.Log("Autosuggest","Suggestion","MouseClick",!1));this.config.enbleClientPerfTelemetry&&typeof this.autosuggest.networkLatencyInfo!=undefined&&this.autosuggest.networkLatencyInfo&&_w.Log&&Log.Log&&Log.Log("Autosuggest","NetworkLatency","PerfInst",!1,"Meta",this.autosuggest.networkLatencyInfo);this.config.sbt&&n.addInst&&!n.nav?this.submitForm(t,n.url):this.navigateToUrl(n,t,i)},h.prototype.submitForm=function(n,i){var e,c,r,u,s,h,f;if(this.config.sbt){for(e=void 0;e=this._hiddenFields.shift();)this.searchForm.removeChild(e);this._hiddenFields=[]}if(n&&(this.raiseEvent(15),this.config.bi&&this._currentImpressionQuery===this.searchBox.value)){sj_evt.fire(t);return}this._instrumentationData=this.autosuggest.getAllSuggestionInstObject(null,n);c=this.getCustomUrlParams(i);r=_ge("sa_ghc");r&&r.parentNode.removeChild(r);for(var l=0,o=void 0,a=[this._instrumentationData,c];o=a[l++];)for(u in o)r=_ge("sa_"+u),s=o[u],r?r.value=s:this.addHiddenField(u,s);this.autosuggest.ghostInstValue=0;n||sj_evt.fire("onSearch",this.searchForm);this.makeSearchboxGPingCall();this.fireEvt?(h=this.searchForm.getAttribute("action"),i&&this.searchForm.setAttribute("action",i),this.searchForm.submit(),this.firePartnerEvents(n),h&&this.searchForm.setAttribute("action",h)):_w._H&&_w._H.ajax&&_w.sj_isAjax&&n||this.searchForm.submit();this.fireEvt&&(this.autosuggest.canvas.selectedSuggestion=null,this.autosuggest.ghostInstValue=0,f=_ge("sa_ghc"),!this._instrumentationData.ghc&&f&&f.parentNode.removeChild(f))},h.prototype.makeSearchboxGPingCall=function(){var t=this.searchForm.getAttributeNode("onsubmit"),n;t&&_w.si_T&&(n=t.value.match(/si_T\('(.*)'\)/),n&&n[1]&&_w.si_T(n[1]))},h.prototype.isMsbSuggestion=function(n){return n=="Bookmark"||n=="Building"||n=="Person"||n=="Qna"||n=="Acronym"||n=="External"||n=="File"||n=="EducationAssignment"||n=="Group"||n=="UserHistory"||n=="External"},h.prototype.navigateToUrl=function(i,r,u){var e,s,h=((e=i.parentElement)===null||e===void 0?void 0:e.id)==o&&this.config.isLowConfidenceWeb,c=((s=i.parentElement)===null||s===void 0?void 0:s.getAttribute("data-region"))=="BAWC",f;if(i.stype==n.BingAtWorkDataTypes.Bookmarks)this.autosuggest.onBfbNavigateCallback(i.id,i.stype,h,i.query,i.getAttribute("logicalId"));else if(i.stype==n.BingAtWorkDataTypes.People)if(this.config.msbSusR)this.autosuggest.onSubstrateNavigateCallback(i.id);else this.autosuggest.onBfbNavigateCallback(i.id,i.stype,h,i.query,i.getAttribute("logicalId"));else if(this.isMsbSuggestion(i.stype))this.autosuggest.onBfbNavigateCallback(i.id,i.stype,h,i.query,i.getAttribute("logicalId"));if(c&&i.getAttribute("menu")==="webSerpMenu")this.autosuggest.onBfbSearchBoxAction("Search_Web_Qf_Click");if(this.searchForm.onsubmit)this.searchForm.onsubmit(null);if(this.firePartnerEvents(r),this.config.bi&&this._currentImpressionQuery===i.query){sj_evt.fire(t);return}f=i.url+(i.addInst?this.autosuggest.getAllSuggestionInstUrl():"");f=this.addExtraQueryStrings(f);i.nav&&!n.Utils.GetQueryStringParam(f,"form")&&(f=this.addFormCode(f));u?_w.open(f,u):typeof sj_lc!="undefined"?sj_lc(f):_w.location.href=f},h.prototype.firePartnerEvents=function(n){!n&&this.fireEvt&&this.fireEvt(this.searchForm,"ASSugClicked")},h.prototype.getCustomUrlParams=function(n){var r={},t;if(n)for(var i=void 0,f=/\+/g,e=/([^&=]+)=?([^&]*)/g,u=function(n){return decodeURIComponent(n.replace(f," "))},o=n.substring(n.indexOf("?")+1);i=e.exec(o);)t=u(i[1]).toLowerCase(),t!=="q"&&t!=="form"&&(r[t]=u(i[2]));return r},h.prototype.bindEvents=function(n,t){var i=this,r;n(sj_b,"click",this.hideDropDownOnFocusChange);n(sj_b,"touchend",this.hideDropDownOnFocusChange);n(this.searchForm,"submit",this.onSubmit);n(this.searchBox,"keydown",this.onSearchBoxKeyDown);this.config.enableSbLeftSpyglass&&this.addSearchBoxLeftSpyglass();"ontouchend"in _w&&n(this.searchBox,"touchend",this.searchBoxTouchAction);n(this.searchBox,"click",this.searchBoxClickAction);this.config.expandOnFocus&&n(this.searchBox,"focus",this.searchBoxClickAction);this.fireEvt&&n(_w,"blur",this.hideDropDownOnFocusChange);r=function(){t("focusChange",function(n){return i.focusChange(n)});t("hideDrawer",function(){return i.hideDropDown(3)})};r();this.config.bi&&t("ajax.load",function(n){var t=n&&n[1];t&&t.isInstantRequest&&(i._currentImpressionQuery=t.query||i.searchBox.value,i.pollForQueryChange(),r())});"oninput"in this.searchBox&&n(this.searchBox,"input",this.onTextInput)},h.prototype.fetchForCurrentQuery=function(){(this._noResultsTimeout&&sb_ct(this._noResultsTimeout),this._bDisabled)||(this._lastQuery=null,this.fetchSuggestions(this.getQueryToFetch(),this.getCurrentQuery(!0)))},h.prototype.showDropDown=function(){if(this._layout.update(),this.fireEvt){var n=this.autosuggest.canvas.containsNextWord?"1":"0";this.searchForm.setAttribute("SuggMode",n);this.fireEvt(this.searchForm,"autosuggestRendered")}this._isLayoutVisible||(sj_evt.fire("focusChange",this.searchBox),this._layout.show(),this._isLayoutVisible=!0,sb_i6&&sj_evt.fire("autosuggestShown",this.searchBox),sj_evt.fire("onPopTR"),this.fireEvt&&this.fireEvt(this.searchForm,"autosuggestShown"),this.searchForm.setAttribute("aria-expanded","true"),this.searchForm.setAttribute("aria-owns","sw_as"))},h.prototype.hideDropDown=function(n,t){n!=0&&(this._lastClickQuery=null);this._isLayoutVisible&&(this.searchForm.setAttribute("aria-expanded","false"),this._layout.hide(),this._isLayoutVisible=!1,this.searchForm.removeAttribute("aria-owns"),n!=0&&(this._lastQuery=this.getQueryToFetch()),this.raiseEvent(16),this.autosuggest.finalizeKeystroke(),t&&this.config.hdm&&sj_pd(t),_w._H&&sj_evt.fire("ASHide"),this.autosuggest.setQuery(undefined));sj_evt.fire("autosuggestHide",this.searchBox,n);this.fireEvt&&(this.searchForm.removeAttribute("SuggMode"),this.fireEvt(this.searchForm,"autosuggestHide"))},h.prototype.focusChange=function(n){n[1]!==this.searchBox&&this.hideDropDown(1)},h.prototype.startNoMatchTimeout=function(){var n=this;this._noResultsTimeout=sb_st(function(){return n.hideDropDown(0)},50)},h.prototype.onUpdateText=function(n){this.getCurrentQuery()!=n&&(this._bRequeryOnTextChange=!1);this.updateSearchBoxValue(n)},h.prototype.updateSearchBoxValue=function(t,r){var u=r?t+r:t,f;this._autoCompletedPrefixLength=r?t.length:null;this.config.ghostingWithGreyText&&r&&(this._ghostingText=r);u!==null&&(this.searchBox.value=u,i||this.searchBox.setAttribute("value",u),f=u.length,f&&this.getCurrentQuery()!=t&&n.Utils.SetSelectionRange(this.searchBox,f,f),t&&t!=this._lastTextChanged&&this.triggerTextChangedEvent(t))},h.prototype.onUpdateTextAndRequery=function(t,i){if(this._bRequeryOnTextChange=!0,this.updateSearchBoxValue(t),!i){var r=t.length;this.searchBox.focus();n.Utils.SetSelectionRange(this.searchBox,r,r)}},h.prototype.onUpdateGhostedText=function(n,t,i){this._bRequeryOnTextChange=i===undefined?!0:i;this.updateSearchBoxValue(n,t)},h.prototype.triggerTextChangedEvent=function(n){this._lastTextChanged=n;this.autosuggest.raiseTextChanged(n,++this._textChangeSequence)},h.prototype.pollForQueryChange=function(){var u=this,n,t,r;this._bDisabled||(n=this.getCurrentQuery(!0),this._lastRawQuery!=n&&(this.autosuggest.setRawQuery(n),this._lastRawQuery=n,this.config.bi&&sj_evt.fire("AS.RawQueryChanged"),t=this.getQueryToFetch(),this._lastQuery==t&&this._bRequeryOnTextChange||i||(this.config.enableSbUpdate&&this.searchBox.setAttribute("value",t),this._isSearchBoxWebComponent&&this.config.enableSbUpdate&&(this.searchBox.value=n)),t!=this._lastQuery&&(this._bRequeryOnTextChange&&!this.suppressRequestForQuery?this.fetchSuggestions(t,n):this.suppressRequestForQuery&&this.config.eNw&&this.config.nwRz&&this._bRequeryOnTextChange?this.hideDropDown(4):this._bRequeryOnTextChange||(this._bRequeryOnTextChange=!0),this._lastQuery=t)),r=this._pollInterval,this._pollThrottlingEnabled&&(r*=1<<Math.max(0,this._pendingRequestCount-e+1)/2),sb_st(function(){return u.pollForQueryChange()},r))},h.prototype.fetchSuggestions=function(n,t){this._noResultsTimeout&&sb_ct(this._noResultsTimeout);this.autosuggest.setCursorPosition(this.adjustCursorPositionForModifiedQuery(t,n));this.autosuggest.setQuery(n);n.length!=0||this.config.fetchOnEmpty||this.config.enableZeroQfWork||this.hideDropDown(0);this._pendingRequestCount++},h.prototype.adjustCursorPositionForModifiedQuery=function(n,t){var r=this.getCursorPosition(),i;if(t!==n&&t!="")for(i=0;i<n.length&&n[i]!=t[0];i++)r--;return r},h.prototype.handleResponseReceived=function(){this._pendingRequestCount--},h.prototype.getQueryToFetch=function(){var t=this.getCurrentQuery();return this.config.trimwsnr&&(t=n.Utils.TrimmedQueryFromSuggestions(this.autosuggest.canvas.currentSuggestionList,t)),t},h.prototype.isQueryGhosted=function(){return!!this._autoCompletedPrefixLength},h.prototype.getCurrentQuery=function(n){var t=this._autoCompletedPrefixLength?this.searchBox.value.substr(0,this._autoCompletedPrefixLength):this.searchBox.value;return n?t:t.replace(this._trimRegex,"").replace(this._removeSpacesRegex," ").toLowerCase()},h.prototype.getPartnerCode=function(n){var u="",i=n.indexOf("pc"),f,t,e,r;return i>=0&&(f=n.indexOf("&",i),r=f>=0?n.substr(i,f-i):n.substr(i),u+="&"+r),t=n.indexOf("pt"),t>=0&&(e=n.indexOf("&",t),r=e>=0?n.substr(t,e-t):n.substr(t),u+="&"+r),u},h.prototype.checkMonitr=function(n){var t=n.indexOf("form=monitr");return t>=0?"&"+n.substr(t,11):""},h.prototype.getPubcode=function(n){if(n.indexOf("pubcode=null")!==-1&&n.indexOf("pt=opentetris")!==-1)return"&pubcode=null";var t=n.indexOf("pubcode");return"&pubcode="+n.substr(t+8,32)},h.prototype.addExtraQueryStrings=function(n){return this.config.pv?n+this.getPubcode(document.URL)+"&pubexp=1&msbqf=false"+this.getPartnerCode(document.URL)+this.checkMonitr(document.URL):n},h.prototype.addFormCode=function(n){return n+"&form="+this.searchForm.form.defaultValue},h.prototype.getLastRequestedQuery=function(){return this._lastQuery},h.prototype.notifyDeleteHistory=function(n){this.raiseEvent(22,n)},h.prototype.dispose=function(){this.clearEvents();this.bindEvents(sj_ue,sj_evt.unbind);sb_ct(this._noResultsTimeout)},h.prototype.isEmptyQuery=function(){var n=_ge("sb_form_q");return n&&!n.value},h.prototype.getContainer=function(){return _ge(this.config.c||"sw_as")},h.ScopeExtensions=[],h}(n.EventRegisterer);n.SearchForm=s})(t=n.AS||(n.AS={}))}(Bing||(Bing={})),function(n){var t;(function(n){var t=function(){function t(){}return t.prototype.getCallbacks=function(){var t=new n.EventRegistration(this);return t.add(11,this.onNoResults),t.add(10,this.onSuggestionsRendered),t},t.prototype.set=function(n){this._data=n;this._data.currentQuery.length<=1&&(this._lastQueryWithNoResults=null)},t.prototype.match=function(){return this._lastQueryWithNoResults&&this._data.currentQuery.substr(0,this._lastQueryWithNoResults.length)==this._lastQueryWithNoResults},t.prototype.onNoResults=function(n){this._lastQueryWithNoResults=n},t.prototype.onSuggestionsRendered=function(t,i,r,u,f){f==n.DataSources.Web&&(this._lastQueryWithNoResults=null)},t}(),i=function(){function t(n){this._searchFormInstance=n;this._exceededNextWordLimit=!1}return t.prototype.getCallbacks=function(){return new n.EventRegistration(this)},t.prototype.set=function(){var t=this._searchFormInstance.getCurrentQuery(),i=this._searchFormInstance.searchBox.offsetWidth,r=n.Utils.CalcWidth(this._searchFormInstance.searchForm,t),u=r/i;this._exceededNextWordLimit=u>.7},t.prototype.match=function(){return this._exceededNextWordLimit},t}(),r=function(){function r(){this._rules=[]}return r.prototype.init=function(t){var i=new n.EventRegistration(this);i.add(6,this.onSearchFormInitialized);t.registerEvents(i)},r.prototype.onSearchFormInitialized=function(n){this._searchFormInstance=n;this.addRules();this.addCallbacks()},r.prototype.addRules=function(){var n=this._searchFormInstance.config;n.eNw&&n.nwLim&&this._rules.push(new i(this._searchFormInstance));n.suppnores&&this._rules.push(new t(n))},r.prototype.addCallbacks=function(){var o=this._rules.length,i,r,t,u,e,f;if(o)for(i=this._searchFormInstance.autosuggest,r=new n.EventRegistration(this),r.add(18,this.onTextChanged),i.registerEvents(r),t=0,u=this._rules;t<u.length;t++)e=u[t],f=e.getCallbacks(),f&&i.registerEvents(f)},r.prototype.updateDataForRules=function(){var n,t,i;for(this._data={currentQuery:this._searchFormInstance.getCurrentQuery()},n=0,t=this._rules;n<t.length;n++)i=t[n],i.set(this._data)},r.prototype.getSuppressRequestForQuery=function(){var n,t,i;if(this._data.currentQuery.length>1)for(n=0,t=this._rules;n<t.length;n++)if(i=t[n],i.match())return 1;return 0},r.prototype.onTextChanged=function(){this.updateDataForRules();this._searchFormInstance.suppressRequestForQuery=this.getSuppressRequestForQuery()},r}();n.SearchForm.ScopeExtensions.push(new r)})(t=n.AS||(n.AS={}))}(Bing||(Bing={})),function(){for(var n,v,t=sa_config,y=new Bing.AS.Canvas,p=Bing.AS.CommonPrefixDataProvider?new Bing.AS.CommonPrefixDataProvider:new Bing.AS.DataProvider,f,e,o,s,h,c,l,r,i,u=0,a=t.enabledDataSources;u<a.length;u++)n=a[u],(n===Bing.AS.DataSources.BingAtWork||n===Bing.AS.DataSources.Substrate||n===Bing.AS.DataSources.MicrosoftSearchInBing)&&(i||(i=AutoSuggest.BingAtWorkWebTelemetry?new AutoSuggest.BingAtWorkWebTelemetry(t,"AS"):null),r||(r=Bing.AS.WebClientInstrumentation?new Bing.AS.WebClientInstrumentation:null)),n===Bing.AS.DataSources.BingAtWork?(f=Bing.AS.CachingDataProvider?new Bing.AS.CachingDataProvider(n):Bing.AS.BingAtWorkDataProvider?new Bing.AS.BingAtWorkDataProvider:null,h=Bing.AS.BingAtWorkSuggestionsParserV3?new Bing.AS.BingAtWorkSuggestionsParserV3(t):null):n===Bing.AS.DataSources.Substrate?(e=Bing.AS.SubstrateDataProvider?new Bing.AS.SubstrateDataProvider(i):null,c=Bing.AS.SubstrateSuggestionsParser?new Bing.AS.SubstrateSuggestionsParser(t):null):n===Bing.AS.DataSources.MicrosoftSearchInBing?(o=Bing.AS.MsbDataProvider?new Bing.AS.MsbDataProvider:null,l=Bing.AS.MsbSuggestionsParser?new Bing.AS.MsbSuggestionsParser(t):null):n===Bing.AS.DataSources.MSBEngagment&&(s=Bing.AS.MSBEngagementDataProvider?new Bing.AS.MSBEngagementDataProvider:null);v=new Bing.AS.WebCore(y,p,f,e,o,s,r,h,c,l,i);sa_inst=new Bing.AS.SearchForm(t,v);sa_inst.init("sa_inst");sa_eL&&sa_inst.show();_w.sj_evt&&sj_evt.fire("autoSugLoaded");sj_evt.bind("ajax.load",function(n){var t=n&&n[1];t&&t.isInstantRequest&&_w.sj_evt&&sj_evt.fire("autoSugLoaded")})}()